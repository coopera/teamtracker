<section class="pull-requests">
  <h1>Latest pull requests</h1>
  <% @pull_requests.each_with_index do |pull_request, i| %>
    <div class="pull-request">
      <div class="pull-request__author">
        <% if pull_request.author.avatar_url %>
          <%= image_tag pull_request.author.avatar_url, class: 'avatar' %>
        <% else %>
          <%= image_tag "http://api.adorable.io/avatars/#{rand(1..3000)}", class: 'avatar' %>
        <% end %>
      </div>
      <div class="pull-request__card">
        <div class="pull-request__info">
          <span class="octicon octicon-git-pull-request"></span>
          <%= link_to pull_request.author.url do %>
            <%= pull_request.author.username %>
          <% end %>
          <%= pull_request.action %>
          <%= link_to pull_request.url do %>
            <%= pull_request.title %>
          <% end %>
          in
          <%= link_to pull_request.repo_url do %>
            <%= pull_request.repo %>
          <% end %>
          <div class="pull-request__date">
            Posted <%= time_ago_in_words(pull_request.time) %> ago
          </div>
        </div>
          <% @pull_requests[i+1..-1].each do |pr| %>
            <% if pr.author == pull_request.author %>
              <% @pull_requests.delete(pr) %>
              <div class="pull-request__info">
                <span class="octicon octicon-git-pull-request"></span>
                <%= link_to pr.author.url do %>
                  <%= pr.author.username %>
                <% end %>
                <%= pr.action %>
                <%= link_to pr.url do %>
                  <%= pr.title %>
                <% end %>
                in
                <%= link_to pr.repo_url do %>
                  <%= pr.repo %>
                <% end %>
                <div class="pull-request__date">
                  Posted <%= time_ago_in_words(pull_request.time) %> ago
                </div>
              </div>
            <% else %>
              <% break %>
            <% end %>
          <% end %>
      </div>
    </div>
  <% end %>
</section>
